# CLAUDE.md â€” changelog-digest

## Project Overview

Build a CLI tool called `changelog-digest` that reads git history and generates plain-English summaries for non-technical teams.

### The Problem We're Solving

- Non-technical teams (Sales, Marketing, Ops, CX) don't have time to talk to engineering
- Remote teams across timezones miss standups and context
- Git commits are too technical for most people to understand
- Teams need async-friendly updates in simple language

### The Solution

A CLI tool that:
1. Reads git commit history from any repository
2. Uses Claude API to translate technical commits into plain English
3. Outputs a clean, readable Markdown or HTML digest

---

## Tech Stack

- **Language:** TypeScript
- **Runtime:** Node.js (>=18)
- **Package Manager:** npm
- **Key Dependencies:**
  - `commander` â€” CLI framework
  - `simple-git` â€” Git operations
  - `@anthropic-ai/sdk` â€” Claude API
  - `chalk` â€” Terminal styling
  - `ora` â€” Loading spinners

---

## Project Structure

```
changelog-digest/
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .env.example
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts          # CLI entry point with commander
â”‚   â”œâ”€â”€ git.ts            # Git history fetching functions
â”‚   â”œâ”€â”€ summarize.ts      # Claude API integration
â”‚   â”œâ”€â”€ formatter.ts      # Output formatting (MD/HTML)
â”‚   â””â”€â”€ types.ts          # TypeScript interfaces
â”œâ”€â”€ examples/
â”‚   â””â”€â”€ sample-output.md
â””â”€â”€ bin/
    â””â”€â”€ changelog-digest  # Executable entry point
```

---

## CLI Interface

### Commands & Options

```bash
# Basic usage (last 7 days)
changelog-digest

# Custom date range
changelog-digest --since "2025-01-01"
changelog-digest --since "2 weeks ago"

# Specify repository path
changelog-digest --repo /path/to/repo

# Output format
changelog-digest --format markdown  # default
changelog-digest --format html

# Output to file
changelog-digest --output changelog.md

# Audience-specific tone (stretch goal)
changelog-digest --audience sales
changelog-digest --audience ops
changelog-digest --audience general  # default
```

---

## Implementation Details

### 1. Git History Reader (`src/git.ts`)

```typescript
interface CommitInfo {
  hash: string;
  date: string;
  author: string;
  message: string;
  body?: string;
}

// Functions to implement:
// - getCommits(repoPath: string, since: string): Promise<CommitInfo[]>
// - parseGitLog(raw: string): CommitInfo[]
```

Use `simple-git` library. Fetch commits with:
- Hash (short)
- Date (ISO format)
- Author name
- Commit message (subject line)
- Body (if present, often has more context)

### 2. Claude Summarizer (`src/summarize.ts`)

```typescript
interface DigestSection {
  category: 'features' | 'fixes' | 'improvements' | 'other';
  items: string[];
}

// Functions to implement:
// - summarizeCommits(commits: CommitInfo[]): Promise<DigestSection[]>
```

**Claude Prompt Strategy:**

```
You are a technical writer who translates git commits into plain English for non-technical teams.

Given these git commits, create a summary with these sections:
- ğŸš€ New Features (things users can now do)
- ğŸ› Bug Fixes (problems that were solved)  
- âš¡ Improvements (things that work better)
- ğŸ”§ Other Changes (internal/technical updates)

Rules:
- Write for someone who doesn't code
- Focus on user/business impact, not technical details
- Keep each item to 1-2 sentences
- Skip merge commits and version bumps
- If a commit is unclear, summarize what you can infer

Commits:
{commits_json}
```

### 3. Output Formatter (`src/formatter.ts`)

```typescript
// Functions to implement:
// - formatMarkdown(sections: DigestSection[], dateRange: string): string
// - formatHTML(sections: DigestSection[], dateRange: string): string
```

**Markdown Template:**

```markdown
# Changelog Digest

**Period:** {start_date} â†’ {end_date}  
**Generated:** {timestamp}

---

## ğŸš€ New Features

- Item 1
- Item 2

## ğŸ› Bug Fixes

- Item 1

## âš¡ Improvements

- Item 1

---

*Generated by [changelog-digest](https://github.com/{username}/changelog-digest)*
```

### 4. CLI Entry Point (`src/index.ts`)

Use `commander` to wire everything together:

```typescript
#!/usr/bin/env node
import { program } from 'commander';

program
  .name('changelog-digest')
  .description('Generate plain-English changelog from git history')
  .version('1.0.0')
  .option('-s, --since <date>', 'Start date for commits', '7 days ago')
  .option('-r, --repo <path>', 'Repository path', '.')
  .option('-f, --format <type>', 'Output format (markdown|html)', 'markdown')
  .option('-o, --output <file>', 'Output file path')
  .option('-a, --audience <type>', 'Target audience (general|sales|ops|cx)', 'general')
  .action(async (options) => {
    // 1. Fetch commits
    // 2. Summarize with Claude
    // 3. Format output
    // 4. Write to file or stdout
  });

program.parse();
```

---

## Environment Variables

```bash
# .env.example
ANTHROPIC_API_KEY=your-api-key-here
```

Use `dotenv` to load. Check for API key on startup, show helpful error if missing.

---

## Error Handling

Handle these cases gracefully:
- Not a git repository
- No commits in date range
- Missing API key
- API rate limits
- Network errors

Show user-friendly error messages with suggestions.

---

## README Requirements

The README is crucial for portfolio impact. Include:

1. **Hero Section**
   - Project name + one-line description
   - Badges (npm version, license, etc.)
   - GIF or screenshot showing it in action

2. **The Problem** (2-3 sentences)

3. **Quick Start**
   ```bash
   npx changelog-digest
   ```

4. **Installation**

5. **Usage Examples** with output

6. **Configuration Options** table

7. **How It Works** (brief)

8. **Contributing**

9. **License** (MIT)

---

## Development Workflow

```bash
# Install dependencies
npm install

# Development mode
npm run dev

# Build
npm run build

# Test locally
npm link
changelog-digest --help

# Run on a test repo
changelog-digest --repo /path/to/any/repo --since "1 month ago"
```

---

## Quality Checklist Before Publishing

- [ ] Works on macOS, Linux, Windows
- [ ] Handles repos with 0 commits gracefully
- [ ] API key error message is helpful
- [ ] README has usage GIF
- [ ] package.json has correct bin entry
- [ ] `.npmignore` excludes unnecessary files
- [ ] License file exists
- [ ] Example output file included

---

## Stretch Goals (After MVP)

1. **GitHub PR integration** â€” Fetch PR titles/descriptions for richer context
2. **Slack webhook** â€” Post digest directly to Slack
3. **Config file** â€” `.changelogrc` for project-specific settings
4. **Multiple output** â€” Generate both MD and HTML at once
5. **Interactive mode** â€” Let user select which commits to include

---

## Commands to Run First

```bash
# Create project
mkdir changelog-digest && cd changelog-digest

# Initialize
npm init -y

# Install dependencies
npm install commander simple-git @anthropic-ai/sdk chalk ora dotenv

# Install dev dependencies
npm install -D typescript @types/node ts-node

# Initialize TypeScript
npx tsc --init

# Create folder structure
mkdir -p src bin examples
```

---

## Success Criteria

The project is done when:
1. `npx changelog-digest` works on any git repo
2. Output is genuinely useful for non-technical readers
3. README looks professional and polished
4. Published to npm (optional but impressive)
5. GitHub repo has clear description, topics, and example output

---

## Notes for Claude Code

- Prioritize working code over perfect code
- Ship MVP first, iterate later
- Test with real git repos during development
- Keep dependencies minimal
- Make terminal output beautiful (colors, spinners)
- Error messages should help users fix the problem
